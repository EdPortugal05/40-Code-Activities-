using System;

class BankAccount
{
    private string AccountNumber { get; }
    private string Pin { get; }
    private decimal Balance { get; set; }
    private int Attempts { get; set; }
    public bool Locked => Attempts >= 3;
    
    public BankAccount(string accountNumber, string pin, decimal balance)
    {
        AccountNumber = accountNumber;
        Pin = pin;
        Balance = balance;
    }
    
    public bool VerifyPin(string pin)
    {
        if (Locked) return false;
        if (pin == Pin)
        {
            Attempts = 0;
            return true;
        }
        Attempts++;
        return false;
    }
    
    public bool Withdraw(decimal amount)
    {
        if (amount <= 0) return false;
        if (Balance >= amount)
        {
            Balance -= amount;
            return true;
        }
        return false;
    }
    
    public void Deposit(decimal amount)
    {
        if (amount > 0) Balance += amount;
    }
    
    public void PrintBalance() => Console.WriteLine($"Current balance: {Balance:C}");
}

class Program
{
    static void Main()
    {
        var account = new BankAccount("123456789", "1234", 1000.00m);
        
        Console.WriteLine("Welcome to Simple ATM");
        
        int attempts = 0;
        bool authenticated = false;
        
        while (attempts < 3 && !authenticated)
        {
            Console.Write("Enter PIN: ");
            string pin = Console.ReadLine();
            
            authenticated = account.VerifyPin(pin);
            
            if (!authenticated)
            {
                attempts++;
                Console.WriteLine($"Invalid PIN. {3 - attempts} attempts remaining.");
            }
        }
        
        if (account.Locked)
        {
            Console.WriteLine("Account locked. Please contact your bank.");
            return;
        }
        
        while (authenticated)
        {
            Console.WriteLine("\n1. Check Balance");
            Console.WriteLine("2. Withdraw");
            Console.WriteLine("3. Deposit");
            Console.WriteLine("4. Exit");
            Console.Write("Choose option: ");
            
            string choice = Console.ReadLine();
            
            switch (choice)
            {
                case "1":
                    account.PrintBalance();
                    break;
                    
                case "2":
                    Console.Write("Enter amount to withdraw: ");
                    if (decimal.TryParse(Console.ReadLine(), out decimal withdrawAmount))
                    {
                        if (account.Withdraw(withdrawAmount))
                            Console.WriteLine("Withdrawal successful");
                        else
                            Console.WriteLine("Insufficient funds");
                    }
                    else
                    {
                        Console.WriteLine("Invalid amount");
                    }
                    break;
                    
                case "3":
                    Console.Write("Enter amount to deposit: ");
                    if (decimal.TryParse(Console.ReadLine(), out decimal depositAmount))
                    {
                        account.Deposit(depositAmount);
                        Console.WriteLine("Deposit successful");
                    }
                    else
                    {
                        Console.WriteLine("Invalid amount");
                    }
                    break;
                    
                case "4":
                    Console.WriteLine("Thank you for using Simple ATM");
                    return;
                    
                default:
                    Console.WriteLine("Invalid option");
                    break;
            }
        }
    }
}
